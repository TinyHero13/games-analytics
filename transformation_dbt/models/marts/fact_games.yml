version: 2

models:
  - name: fact_games
    description: "Fact table containing games with metrics and keys to dimensions"
    columns:
      - name: igdb_id
        description: "Unique game identifier in IGDB"
        tests:
          - not_null
          - unique

      - name: game_name
        description: "Game name"
        tests:
          - not_null

      - name: summary
        description: "Game summary/description"

      - name: total_rating
        description: "Total game rating"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: total_rating_count
        description: "Number of reviews for total rating"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: release_date
        description: "Game release date"

      - name: total_companies
        description: "Total number of companies involved with the game"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: total_developers
        description: "Total number of game developers"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: total_publishers
        description: "Total number of game publishers"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: primary_developer_key
        description: "Primary developer company key"
        tests:
          - relationships:
              to: ref('dim_companies')
              field: company_key

      - name: primary_publisher_key
        description: "Primary publisher company key"
        tests:
          - relationships:
              to: ref('dim_companies')
              field: company_key

      - name: total_genres
        description: "Total number of game genres"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: genre_keys
        description: "Array of game genre keys"

      - name: total_keywords
        description: "Total number of game keywords"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: total_languages
        description: "Total number of supported languages"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: audio_languages
        description: "Number of languages with audio support"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: subtitle_languages
        description: "Number of languages with subtitle support"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: interface_languages
        description: "Number of languages with interface support"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: total_game_modes
        description: "Total number of game modes"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: has_single_player
        description: "Indicates if the game has single player mode"
        tests:
          - accepted_values:
              values: [0, 1]

      - name: has_multiplayer
        description: "Indicates if the game has multiplayer mode"
        tests:
          - accepted_values:
              values: [0, 1]

      - name: has_coop
        description: "Indicates if the game has cooperative mode"
        tests:
          - accepted_values:
              values: [0, 1]

      - name: game_mode_keys
        description: "Array of game mode keys"

      - name: total_platforms
        description: "Total number of game platforms"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: platform_keys
        description: "Array of platform keys"

      - name: total_themes
        description: "Total number of game themes"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: twitch_viewers
        description: "Average Twitch viewers"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: twitch_channels
        description: "Average channels broadcasting the game on Twitch"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: twitch_rank
        description: "Twitch popularity ranking"
        tests:
          - dbt_utils.accepted_range:
              min_value: 1

      - name: hours_watched
        description: "Total hours watched on Twitch"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: twitch_tracking_days
        description: "Number of days tracked on Twitch"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: daily_hours_watched
        description: "Average hours watched per day on Twitch"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

      - name: has_twitch_presence
        description: "Indicates if the game has Twitch presence"

      - name: updated_at
        description: "Last record update timestamp"
        tests:
          - not_null
